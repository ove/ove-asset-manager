sudo: false
language: bash

services:
  - docker

stages:
  - build
  - name: deploy
    if: branch = master AND type != pull_request

jobs:
  include:
    - stage: build
      script: docker-compose build
    - stage: deploy
      script:
        - docker-compose build
        - echo "${DOCKER_PASSWORD}" | docker login -u "${DOCKER_USERNAME}" --password-stdin
        - docker-compose push